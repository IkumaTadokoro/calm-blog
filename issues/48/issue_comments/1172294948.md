---
author_association: OWNER
created_at: '2022-07-01T12:29:12Z'
html_url: https://github.com/IkumaTadokoro/diary/issues/48#issuecomment-1172294948
id: 1172294948
issue_url: https://api.github.com/repos/IkumaTadokoro/diary/issues/48
node_id: IC_kwDOHWTPVs5F380k
performed_via_github_app: 
reactions:
  "+1": 0
  "-1": 0
  confused: 0
  eyes: 0
  heart: 0
  hooray: 0
  laugh: 0
  rocket: 0
  total_count: 0
  url: https://api.github.com/repos/IkumaTadokoro/diary/issues/comments/1172294948/reactions
updated_at: '2022-07-01T12:29:12Z'
url: https://api.github.com/repos/IkumaTadokoro/diary/issues/comments/1172294948
user:
  avatar_url: https://avatars.githubusercontent.com/u/61409641?v=4
  events_url: https://api.github.com/users/IkumaTadokoro/events{/privacy}
  followers_url: https://api.github.com/users/IkumaTadokoro/followers
  following_url: https://api.github.com/users/IkumaTadokoro/following{/other_user}
  gists_url: https://api.github.com/users/IkumaTadokoro/gists{/gist_id}
  gravatar_id: ''
  html_url: https://github.com/IkumaTadokoro
  id: 61409641
  login: IkumaTadokoro
  node_id: MDQ6VXNlcjYxNDA5NjQx
  organizations_url: https://api.github.com/users/IkumaTadokoro/orgs
  received_events_url: https://api.github.com/users/IkumaTadokoro/received_events
  repos_url: https://api.github.com/users/IkumaTadokoro/repos
  site_admin: false
  starred_url: https://api.github.com/users/IkumaTadokoro/starred{/owner}{/repo}
  subscriptions_url: https://api.github.com/users/IkumaTadokoro/subscriptions
  type: User
  url: https://api.github.com/users/IkumaTadokoro

---
# TypeScriptã§Google Apps Scriptã‚’æ›¸ã“ã†ï¼

## ã¨ã‚Šã‚ãˆãšã‚¹ã‚¯ãƒ©ãƒƒãƒ—

https://zenn.dev/kyo9bo/articles/ffc0d8b8076052

https://zenn.dev/fillz_noh/articles/c6a3a504b0cefc

https://zenn.dev/phi/articles/google-apps-script-snippets

https://zenn.dev/offers/articles/20220616-google-app-script-technique

https://zenn.dev/daria_nicht/articles/41c39bb4413db8

https://zenn.dev/kkenjii/articles/gas-clasp-usage

claspã‚’ä½¿ã£ã¦ã€TypeScriptã§GASã‚’æ›¸ãã®ãŒè‰¯ã•ãã†ã€‚
- è‡ªå‹•åŒ–ã®é¸æŠè‚¢ã‚’åºƒã’ã‚‰ã‚Œã‚‹ã¨è‰¯ã„ã€‚
- TypeScriptã®ç·´ç¿’ã«ä½¿ãˆã‚‹ã¨è‰¯ã•ãã†

## claspã‚’ä½¿ã£ã¦ã¿ã‚‹

https://github.com/google/clasp

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
$ npm i @google/clasp -g
```

### ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹

```bash
$ clasp login
Logging in globallyâ€¦
ğŸ”‘ Authorize clasp by visiting this url:
https://accounts.google.com/o/oauth2/v2/auth?access_type=offline&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fscript.deployments%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fscript.projects%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fscript.webapp.deploy%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.metadata.readonly%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fservice.management%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Flogging.read%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcloud-platform&response_type=code&client_id=1072944905499-vm2v2i5dvn0a0d2o4ca36i1vge8cvbn0.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A65472

Authorization successful.

Default credentials saved to: /Users/tadokoroikuma/.clasprc.json.
```

### claspã§TypeScriptã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹

https://github.com/google/clasp/blob/master/docs/typescript.md

```bash
$ mkdir hello-world-clasp
$ cd hello-world-clasp
$ npm i @types/google-apps-script
$ vim tsconfig.json
````

```json
{
  "compilerOptions": {
    "lib": ["es2022"],
    "experimentalDecorators": true
  }
}
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

```
â¯ clasp create --help
Usage: clasp create [options]

Create a script

Options:
  --type <type>        Creates a new Apps Script project attached to a new Document, Spreadsheet, Presentation, Form, or as a standalone script, web app, or API.
  --title <title>      The project title.
  --parentId <id>      A project parent Id.
  --rootDir <rootDir>  Local root directory in which clasp will store your project files.
  -h, --help           display help for command

$ clasp create --title "Hello World" --type standalone

$ ls -la
# appscript.jsonãŒä½œæˆã•ã‚Œã‚‹
```

TimezoneãŒAmerica/NewYorkãªã®ã§ã€Asia/Tokyoã«å¤‰æ›´ã™ã‚‹

```json
{
  "timeZone": "Asia/Tokyo",
  "dependencies": {
  },
  "exceptionLogging": "STACKDRIVER",
  "runtimeVersion": "V8"
}
~
```

### Hello World

```typescript:hello.ts
const greeter = (person: string) => {
  return `Hello, ${person}!`;
}

const testGreeter() {
  const user = 'ikuma';
  Logger.log(greeter(user))
}
```

ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹

```bash
â¯ clasp push
? Manifest file has been updated. Do you want to push and
overwrite? Yes
â””â”€ appsscript.json
â””â”€ hello.ts
Pushed 2 files.
```

æ­£ç›´ä½•ã‚’ä¸Šæ›¸ãã—ãŸã®ã‹ã¯ã‚ã‹ã‚‰ãªã„


```bash
$ clasp open
```

ã“ã‚Œã§ã‚¦ã‚§ãƒ–ã®ã‚¨ãƒ‡ã‚£ã‚¿ãŒé–‹ãã€‚`hello.gs`ãŒè¡¨ç¤ºã•ã‚ŒãŸã€‚

```javascript
// Compiled using hello-world-clasp 1.0.0 (TypeScript 4.7.4)
var greeter = function (person) {
    return "Hello, ".concat(person, "!");
};
var testGreeter;
(function () {
    var user = 'ikuma';
    Logger.log(greeter(user));
});
```

TypeScriptã‚‚æœ€æ–°ã£ã½ã„ã­

Logger.logãŒè¡¨ç¤ºã•ã‚Œãªã„â†’testGreeterãŒé–¢æ•°ã˜ã‚ƒãªã‹ã£ãŸ

```typescript:hello.ts
const greeter = (person: string) => {
  return `Hello, ${person}!`;
}

const testGreeter = ():void => {
  const user = 'ikuma';
  Logger.log(greeter(user))
}
```

