---
author_association: OWNER
created_at: '2022-07-09T12:57:27Z'
html_url: https://github.com/IkumaTadokoro/diary/issues/54#issuecomment-1179539181
id: 1179539181
issue_url: https://api.github.com/repos/IkumaTadokoro/diary/issues/54
node_id: IC_kwDOHWTPVs5GTlbt
performed_via_github_app: 
reactions:
  "+1": 0
  "-1": 0
  confused: 0
  eyes: 0
  heart: 0
  hooray: 0
  laugh: 0
  rocket: 0
  total_count: 0
  url: https://api.github.com/repos/IkumaTadokoro/diary/issues/comments/1179539181/reactions
updated_at: '2022-07-09T12:57:27Z'
url: https://api.github.com/repos/IkumaTadokoro/diary/issues/comments/1179539181
user:
  avatar_url: https://avatars.githubusercontent.com/u/61409641?v=4
  events_url: https://api.github.com/users/IkumaTadokoro/events{/privacy}
  followers_url: https://api.github.com/users/IkumaTadokoro/followers
  following_url: https://api.github.com/users/IkumaTadokoro/following{/other_user}
  gists_url: https://api.github.com/users/IkumaTadokoro/gists{/gist_id}
  gravatar_id: ''
  html_url: https://github.com/IkumaTadokoro
  id: 61409641
  login: IkumaTadokoro
  node_id: MDQ6VXNlcjYxNDA5NjQx
  organizations_url: https://api.github.com/users/IkumaTadokoro/orgs
  received_events_url: https://api.github.com/users/IkumaTadokoro/received_events
  repos_url: https://api.github.com/users/IkumaTadokoro/repos
  site_admin: false
  starred_url: https://api.github.com/users/IkumaTadokoro/starred{/owner}{/repo}
  subscriptions_url: https://api.github.com/users/IkumaTadokoro/subscriptions
  type: User
  url: https://api.github.com/users/IkumaTadokoro

---
WebDriver

どぉらいばぁ〜

- WebDriverに対して、各種言語のSDKが提供されている
- Selenium公式ライブラリと非公式ライブラリがあるみたい。Rubyは公式がある。
- とりあえずRubyで書くか

```ruby
gem install selenium-webdriver
```

https://github.com/SeleniumHQ/selenium/tree/trunk/rb

おお、Subversionから移行した感じがするブランチだ！かなり頻繁にメンテされているな〜。

```ruby
require "selenium-webdriver'

driver = Selenium::WebDriver.for :firefox
driver.get('http://example.selenium.jp/reserveApp')
driver.find_element(:id, 'guestname).send_keys('サンプルユーザ')
driver.find_element(:id, 'goto_next').click
driver.quit
```

実行結果

```bash
$ ruby webdriver-sample-for-firefox.rb
webdriver-sample-for-firefox.rb:7: unterminated string meets end of file
driver.quit
```

あ、typoしてるわ。`'`が一個足りない。直したけど同じだ。FireFoxがないせいだと思って取り合えず追加する。
あ〜、`require`のところもクォート間違えてたわ。ってことでここからRubyMineにしました。

```bash
.asdf/installs/ruby/3.1.2/lib/ruby/gems/3.1.0/gems/selenium-webdriver-4.3.0/lib/selenium/webdriver/common/service.rb:104:in `binary_path': Unable to find Mozilla geckodriver. Please download the server from (Selenium::WebDriver::Error::WebDriverError)
https://github.com/mozilla/geckodriver/releases and place it somewhere on your PATH.
More info at https://developer.mozilla.org/en-US/docs/Mozilla/QA/Marionette/WebDriver
```

`Mozilla geckodriver`が見つからないと言われている。本にはそのまま動くと書いてあるけどつまりましたねぇ。いいですね。

`https://developer.mozilla.org/en-US/docs/Mozilla/QA/Marionette/WebDriver`を参照しようと思うけど、リンクがきれているな。

現状どうなっているか見ようと思ってcloneしているけど、リポジトリがデカすぎて全然終わらない。終わる感じはあるけど。

ダウンロードしている間にgeckodriverを追加する。月光？

https://ja.wikipedia.org/wiki/Gecko

ああ「トッケイヤモリ」の方みたい。

> Gecko（ゲッコー）は、Netscapeシリーズ 6以降およびMozillaソフトウェアのために開発されたオープンソースのHTMLレンダリングエンジン群の総称である。HTML、CSS、XUL、JavaScriptなどを解釈する。

はええ！

> 当初、Mozillaは1998年に公開されたNetscape 5.0へ向けて開発中だったソースコードを元に開発されていたが[5]、軽量化のために当時買収したDigital Style社のエンジンをベースにして新規に書かれた。これがGeckoである。パース部分はW3Cによる勧告に合致することを目標に作成されている。

エラーによって思わぬことを学んだ。バージョン履歴の5.0の次が57なのがなんか面白いな。


と調べている間にダウンロード終わって該当箇所が出てきた。

lib/selenium/webdriver/firefox/service.rb:29

2016年が最後。PR作るか〜。既存Issueがないか調べる。なさそう。
というかこのアドレス、もともとはどこを表示したかったんだろう？それがわからないとPRの作りようがないんだけど。

魚拓はこれ。

https://archive.ph/20170813105309/https://developer.mozilla.org/en-US/docs/Mozilla/QA/Marionette/WebDriver

ここが少し近いかな〜

https://developer.mozilla.org/en-US/docs/Learn/Tools_and_testing/Cross_browser_testing/Your_own_automation_environment

う〜ん、一旦保留にして進めるか。

---

https://github.com/mozilla/geckodriver

これ更新めっちゃ止まっているけどいいのかな〜。まあ使ってみよう。

https://github.com/mozilla/geckodriver/releases/tag/v0.31.0

これが最新版なので、ダウンロードして適当に配置

```bash
export PATH=$PATH:/path/to/geckodriver
```

これで再実行してみる。同じエラーが出てしまうなあ。
