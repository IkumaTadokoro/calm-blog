---
author_association: OWNER
created_at: '2022-06-11T02:32:54Z'
html_url: https://github.com/IkumaTadokoro/diary/issues/28#issuecomment-1152838491
id: 1152838491
issue_url: https://api.github.com/repos/IkumaTadokoro/diary/issues/28
node_id: IC_kwDOHWTPVs5Etutb
performed_via_github_app: 
reactions:
  "+1": 0
  "-1": 0
  confused: 0
  eyes: 0
  heart: 0
  hooray: 0
  laugh: 0
  rocket: 0
  total_count: 0
  url: https://api.github.com/repos/IkumaTadokoro/diary/issues/comments/1152838491/reactions
updated_at: '2022-06-11T02:32:54Z'
url: https://api.github.com/repos/IkumaTadokoro/diary/issues/comments/1152838491
user:
  avatar_url: https://avatars.githubusercontent.com/u/61409641?v=4
  events_url: https://api.github.com/users/IkumaTadokoro/events{/privacy}
  followers_url: https://api.github.com/users/IkumaTadokoro/followers
  following_url: https://api.github.com/users/IkumaTadokoro/following{/other_user}
  gists_url: https://api.github.com/users/IkumaTadokoro/gists{/gist_id}
  gravatar_id: ''
  html_url: https://github.com/IkumaTadokoro
  id: 61409641
  login: IkumaTadokoro
  node_id: MDQ6VXNlcjYxNDA5NjQx
  organizations_url: https://api.github.com/users/IkumaTadokoro/orgs
  received_events_url: https://api.github.com/users/IkumaTadokoro/received_events
  repos_url: https://api.github.com/users/IkumaTadokoro/repos
  site_admin: false
  starred_url: https://api.github.com/users/IkumaTadokoro/starred{/owner}{/repo}
  subscriptions_url: https://api.github.com/users/IkumaTadokoro/subscriptions
  type: User
  url: https://api.github.com/users/IkumaTadokoro

---
https://vuejs.org/guide/essentials/watchers.html

## Basic Example

```vue
<script setup>
import { ref, watch } from 'vue'

const question = ref('')
const answer = ref('Questions usually contain a question mark. ;-)')

// questionを監視する
watch(question, async (newQuestion, oldQuestion) => {
  if (newQuestion.indexOf('?') > -1) {
    answer.value = 'Thinking...'
    try {
      const res = await fetch('https://yesno.wtf/api')
      answer.value = (await res.json()).answer
    } catch (error) {
      answer.value = 'Error! Could not reach the API. ' + error
    }
  }
})
</script>

<template>
  <p>
    Ask a yes/no question:
    <input v-model="question" />
  </p>
  <p>{{ answer }}</p>
</template>
```

## Deep Watchers 

- `watch`の第一引数にはリアクティブなものも置けるし、単純なgetter関数も置けるけど、リアクティブな値を選択するとオブジェクトに対して、deepにwatchする。

## `watchEffect()`

- コールバック関数内で定義されている変数が監視対象になる。

## `watch` vs `watchEffect`

- `watch`: 明示的に監視対象を指定して実行する。コールバック関数の中でアクセスされている値は検知されず、監視対象が変更された場合のみコールバックが実行される。対象の監視とそれに対する副作用が別々に定義される。
- `watchEffect`: 対象の監視とそれに対する副作用が同時に定義される。

## Callback flush timing

- `watch`の第3引数、`watchEffect`の第2引数にはオプションを指定できる、
- デフォルトでは、watcherはVueのコンポーネントが更新される前に実行されるので、更新後の値にアクセスしたい場合は、`{ flush: post }`オプションを指定する

---

終幕