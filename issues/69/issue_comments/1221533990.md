---
author_association: OWNER
created_at: '2022-08-21T12:14:46Z'
html_url: https://github.com/IkumaTadokoro/diary/issues/69#issuecomment-1221533990
id: 1221533990
issue_url: https://api.github.com/repos/IkumaTadokoro/diary/issues/69
node_id: IC_kwDOHWTPVs5IzyEm
performed_via_github_app: 
reactions:
  "+1": 0
  "-1": 0
  confused: 0
  eyes: 0
  heart: 0
  hooray: 0
  laugh: 0
  rocket: 0
  total_count: 0
  url: https://api.github.com/repos/IkumaTadokoro/diary/issues/comments/1221533990/reactions
updated_at: '2022-08-21T12:14:46Z'
url: https://api.github.com/repos/IkumaTadokoro/diary/issues/comments/1221533990
user:
  avatar_url: https://avatars.githubusercontent.com/u/61409641?v=4
  events_url: https://api.github.com/users/IkumaTadokoro/events{/privacy}
  followers_url: https://api.github.com/users/IkumaTadokoro/followers
  following_url: https://api.github.com/users/IkumaTadokoro/following{/other_user}
  gists_url: https://api.github.com/users/IkumaTadokoro/gists{/gist_id}
  gravatar_id: ''
  html_url: https://github.com/IkumaTadokoro
  id: 61409641
  login: IkumaTadokoro
  node_id: MDQ6VXNlcjYxNDA5NjQx
  organizations_url: https://api.github.com/users/IkumaTadokoro/orgs
  received_events_url: https://api.github.com/users/IkumaTadokoro/received_events
  repos_url: https://api.github.com/users/IkumaTadokoro/repos
  site_admin: false
  starred_url: https://api.github.com/users/IkumaTadokoro/starred{/owner}{/repo}
  subscriptions_url: https://api.github.com/users/IkumaTadokoro/subscriptions
  type: User
  url: https://api.github.com/users/IkumaTadokoro

---
で、次にgeneratorの生成をやっている。

```go
generator := gen.Generators()["go"]
if generator == nil {
	return errors.New("no generator")
}
```

`gen.Generators()`の中身はこうなっている。

```go
type Generator func([]*pdl.Domain, string) (Emitter, error)

// Generators returns all the various Chrome DevTools Protocol generators.
func Generators() map[string]Generator {
	return map[string]Generator{
		"go": NewGoGenerator,
	}
}
```

いまいちこの`type`による関数定義が何をしているのかよくわかっていない。

https://qiita.com/tenntenn/items/45c568d43e950292bc31

> typeという予約語を用いると、既存の型や型リテラルに別名をつけることができます

あ〜、この記事で一番大事なのはここだ

> typeやメソッドが構造体ありきで学習していくと、後々、http.HandlerFuncなどに出くわしたときに、きちんと理解できず、「おまじない」になってしまいがちです。言語仕様をきちんと読み、普段なんとなく書いている記述が文法上どのように定義されているのか理解することで、今まできちんと理解してなかった概念や知らなかった概念を知る機会になります。Goの言語仕様は、そんなに長くなく、少しずつ読んでいけばちゃんと読める量なので、ぜひ読んでみることをオススメします。英語が厳しい方は、文法を定義したBNFを斜め読みするだけでも十分効果はあると思います。

とりあえずこの部分については、`([]*pdl.Domain, string)`を引数に取り、`(Emitter, error)`を戻り値として返す関数を`Generator`という名前の型として定義しますよ、ってことだ。

で、このEmitterについては直後に定義があって、

```go
type Emitter interface {
	Emit() map[string]*bytes.Buffer
}
```

で、元に戻って、`NewGoGenerator`は何かという話。

```go
func Generators() map[string]Generator {
	return map[string]Generator{
		"go": NewGoGenerator,
	}
}
```

これは`pdlgen/gen/gogen.go`に定義されている。ここが核であり、おそらくこの生成結果によって、後ちょっとでpanicになる。`
